
# test time.sleep()

```python
import time

granularity = 0.5
timeRange = 10 + granularity
testTime = 1000

target = granularity

while target < timeRange:
    passed = []
    for i in range(1, testTime):
        timeA = time.time() * 1000
        time.sleep(target / 1000)
        timeB = time.time() * 1000
        passed.append(timeB - timeA)
    averagePassed = sum(passed) / len(passed)
    print(str(round(target, 3)) + '\t' + str(round(averagePassed, 3)) + '\t' + str(round(averagePassed - target, 3)))

    target += granularity

```

20 cases(0~20ms,step 0.5ms), 1000 times per case

## On amd64-linux

| expected time | real time | sleep jitter |
| ------------- | --------- | ------------ |
| 0.5           | 1.122     | 0.622        |
| 1             | 1.388     | 0.388        |
| 1.5           | 2.051     | 0.551        |
| 2             | 2.67      | 0.67         |
| 2.5           | 2.833     | 0.333        |
| 3             | 3.449     | 0.449        |
| 3.5           | 4.263     | 0.763        |
| 4             | 4.603     | 0.603        |
| 4.5           | 5.277     | 0.777        |
| 5             | 5.719     | 0.719        |
| 5.5           | 6.195     | 0.695        |
| 6             | 6.867     | 0.867        |
| 6.5           | 7.088     | 0.588        |
| 7             | 7.794     | 0.794        |
| 7.5           | 8.098     | 0.598        |
| 8             | 8.777     | 0.777        |
| 8.5           | 9.181     | 0.681        |
| 9             | 9.717     | 0.717        |
| 9.5           | 10.275    | 0.775        |
| 10            | 10.619    | 0.619        |

## On riscv64-linux (unmatched)

| expected time | real time | sleep jitter |
| ------------- | --------- | ------------ |
| 0.5           | 3.99      | 3.49         |
| 1             | 3.992     | 2.992        |
| 1.5           | 3.996     | 2.496        |
| 2             | 3.996     | 1.996        |
| 2.5           | 4.008     | 1.508        |
| 3             | 4.008     | 1.008        |
| 3.5           | 4.011     | 0.511        |
| 4             | 7.991     | 3.991        |
| 4.5           | 7.992     | 3.492        |
| 5             | 7.992     | 2.992        |
| 5.5           | 7.991     | 2.491        |
| 6             | 7.99      | 1.99         |
| 6.5           | 7.992     | 1.492        |
| 7             | 7.991     | 0.991        |
| 7.5           | 8         | 0.5          |
| 8             | 11.991    | 3.991        |
| 8.5           | 11.992    | 3.492        |
| 9             | 11.991    | 2.991        |
| 9.5           | 11.99     | 2.49         |
| 10            | 11.99     | 1.99         |

## On riscv64-linux (qemu-system)

| target time | real time | sleep jitter |
| ----------- | --------- | ------------ |
| 0.5         | 3.942     | 3.442        |
| 1           | 3.947     | 2.947        |
| 1.5         | 3.97      | 2.47         |
| 2           | 4.027     | 2.027        |
| 2.5         | 4.205     | 1.705        |
| 3           | 4.561     | 1.561        |
| 3.5         | 5.977     | 2.477        |
| 4           | 7.185     | 3.185        |
| 4.5         | 7.803     | 3.303        |
| 5           | 7.885     | 2.885        |
| 5.5         | 7.931     | 2.431        |
| 6           | 7.987     | 1.987        |
| 6.5         | 8.045     | 1.545        |
| 7           | 8.536     | 1.536        |
| 7.5         | 10.106    | 2.606        |
| 8           | 11.3      | 3.3          |
| 8.5         | 11.781    | 3.281        |
| 9           | 11.924    | 2.924        |
| 9.5         | 11.941    | 2.441        |
| 10          | 12.005    | 2.005        |

## On amd64-windows11

| expected time | real time | sleep jitter |
| ------------- | --------- | ------------ |
| 0.5           | 15.655    | 15.155       |
| 1             | 15.681    | 14.681       |
| 1.5           | 15.7      | 14.2         |
| 2             | 15.669    | 13.669       |
| 2.5           | 15.726    | 13.226       |
| 3             | 15.638    | 12.638       |
| 3.5           | 15.629    | 12.129       |
| 4             | 15.577    | 11.577       |
| 4.5           | 15.449    | 10.949       |
| 5             | 15.667    | 10.667       |
| 5.5           | 15.639    | 10.139       |
| 6             | 15.639    | 9.639        |
| 6.5           | 15.642    | 9.142        |
| 7             | 15.636    | 8.636        |
| 7.5           | 15.678    | 8.178        |
| 8             | 15.677    | 7.677        |
| 8.5           | 15.606    | 7.106        |
| 9             | 15.651    | 6.651        |
| 9.5           | 15.648    | 6.148        |
| 10            | 15.696    | 5.696        |
